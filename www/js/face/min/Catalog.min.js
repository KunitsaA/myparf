function Format_Scena(a){return accounting.formatNumber(a.s_cena,0," ")}function Format_Cena(a){return accounting.formatNumber(a.cena,0," ")}function Format_Type(a){return a.t_name.toLowerCase()}function Format_Img(a){return""!=a.ims1?a.ims1:"img/no_foto.jpg"}function Load_Price(obj){var min_pr=2e4,max_pr=1,val_str="",typeLength=$(".Filtr_type input:checked").length;typeLength>1?$(".Filtr_type input:checked").each(function(a,r){val_str+=0==a?"obj[i].type == "+$(this).val():" || obj[i].type == "+$(this).val()}):1==typeLength&&(val_str+="obj[i].type == "+$(".Filtr_type input:checked").val());var dataLength=obj.length;for(i=0;i<dataLength;++i)""!=val_str?eval(val_str)&&(obj[i].s_cena>0?(obj[i].s_cena<min_pr&&(min_pr=parseFloat(obj[i].s_cena)),obj[i].s_cena>max_pr&&(max_pr=parseFloat(obj[i].s_cena))):(obj[i].cena<min_pr&&(min_pr=parseFloat(obj[i].cena)),obj[i].cena>max_pr&&(max_pr=parseFloat(obj[i].cena)))):obj[i].s_cena>0?(obj[i].s_cena<min_pr&&(min_pr=parseFloat(obj[i].s_cena)),obj[i].s_cena>max_pr&&(max_pr=parseFloat(obj[i].s_cena))):(obj[i].cena<min_pr&&(min_pr=parseFloat(obj[i].cena)),obj[i].cena>max_pr&&(max_pr=parseFloat(obj[i].cena)));min_val=$(".Filtr_price .min_price").val(),max_val=$(".Filtr_price .max_price").val(),$(".Filtr_price .min_price").attr("min",min_pr).attr("max",max_pr).attr("placeholder",min_pr),""!=min_val&&(min_val=parseFloat(min_val),min_val<min_pr?$(".Filtr_price .min_price").val(min_pr):min_val>max_pr&&$(".Filtr_price .min_price").val(max_pr)),$(".Filtr_price .max_price").attr("min",min_pr).attr("max",max_pr).attr("placeholder",max_pr),""!=max_val&&(max_val=parseFloat(max_val),max_val<min_pr?$(".Filtr_price .max_price").val(min_pr):max_val>max_pr&&$(".Filtr_price .max_price").val(max_pr))}$(document).ready(function(){function a(a){a>$(".Object").length&&($('<center><div class="cols col-12"><a id="show_more" href="#">показать еще</a></div></center>').appendTo(".colsproducts"),$(".Page_navigation").remove())}function r(a,r){var e=a[0],t=a[1],i=(a[2],a[3]),n=(a[4],a[5]);if(r.indexOf("?")+1){var o=r.split(/[&?]{1}/);new_url=o[0]}else new_url=r;var c="";return""!=e&&(c+="type="+e),""!=t&&(c+=""!=c?"&min="+t:"min="+t),""!=i&&(c+=""!=c?"&max="+i:"max="+i),""!=n&&n>1&&(c+=""!=c?"&sort="+n:"sort="+n),""!=c&&(new_url+="?"+c),new_url}function e(){var a=0,r="";$(".Filtr_type input:checked").each(function(){var e=$(this);r+=0==a?e.val():","+e.val(),a++});var e=$(".Filtr_price .min_price").val(),t=parseFloat($(".Filtr_price .min_price").attr("min")),i=$(".Filtr_price .max_price").val(),n=parseFloat($(".Filtr_price .max_price").attr("max")),o=parseFloat($("#sort").val()),c=[r,e,t,i,n,o];return c}var t=$('<a class="hide_filtr" href="#" ><div class="icon"></div>Скрыть фильтр</a>'),n=$('<a class="show_filtr" href="#" ><div class="icon"></div>Показать фильтр</a>'),o=$('<div class="Filtr_show"><a href="#" class="Filtr_button">Показать</a></div>'),c=$('<div id="Up"><a id="Up_button" href="#" title="Вверх"></a></div>'),l=window.location.href,p=$("#this_cat").val(),_=$("#this_brand").val(),s=$("#this_all").val(),m=e(),v=$(window).height();a(s),$(window).off("scroll"),$(window).on("scroll",function(){var a=$(window).scrollTop(),r=$("#Up").length;if(a>=v){if(0==r){var e=$(window).width(),t=$(".catalog").find(".row_wrap").width(),i=(e-t)/2-80;0>i&&(i=10),c.css("right",i+"px").appendTo(".colsproducts")}}else r>0&&$("#Up").remove()}),$(".colsproducts").off("click","#Up_button"),$(".colsproducts").on("click","#Up_button",function(a){$("body,html").animate({scrollTop:0},500),a.preventDefault()}),$(".colsproducts").on("click","#show_more",function(a){a.preventDefault();var r=$(this),e=r.parent(),t=$(".Object").length,n={type:m[0],min:m[1],min_val:m[2],max:m[3],max_val:m[4],sort:m[5],cat:p,brand:_,c_obj:t};r.remove(),$('<img id="load_img" src="img/load_gif.GIF" alt="Загрузка" />').appendTo(e),$.ajax({type:"POST",data:{data:n},url:"controllers/face/Filtr_controller.php",dataType:"json",success:function(a){$("#ObjectTmpl").tmpl(a).appendTo($(".Object").parent().parent()),$("#load_img").remove(),$(".Object").length<s&&$('<a id="show_more" href="#">показать еще</a>').appendTo(e);var r=a.length;for(i=0;i<r;i++){var t=$('.Object[data-id="'+a[i].id+'"').find(".name"),n=t.text();n.indexOf("(")&&(n=n.replace(/\((.+)\)/,"<span>($1)</span>"),t.html(n))}},error:function(a,r,e){}})}),t.prependTo(".showhide"),$(".showhide").on("click",".hide_filtr",function(a){$(".colsfiltr").css({display:"none"}),$(this).remove(),n.prependTo(".showhide"),a.preventDefault()}),$(".showhide").on("click",".show_filtr",function(a){$(".colsfiltr").css({display:"table-cell"}),$(this).remove(),t.prependTo(".showhide"),a.preventDefault()}),$(".colsfiltr").off("change",'input[type="number"]'),$(".colsfiltr").on("change",'input[type="number"]',function(a){var r=$(this),e=parseFloat(r.val()),t=parseFloat(r.attr("min")),i=parseFloat(r.attr("max"));t>e?r.val(t):e>i&&r.val(i);var n=r.parent();$(".Filtr_show").remove(),o.appendTo(n)});var d=new Object,f={cat:p,brand:_};$.ajax({type:"POST",data:{data:f},url:"controllers/face/Price.php",dataType:"json",success:function(a){d=a},error:function(a,r,e){}}),$(".colsfiltr").off("change checked click",".filtr_check"),$(".colsfiltr").on("change checked click",".filtr_check",function(a){var r=$(this),e=r.parent();$(".Filtr_show").remove(),o.appendTo(e),Load_Price(d)}),$(".colsfiltr").off("change","#sort"),$(".colsfiltr").on("change","#sort",function(){var a=e(),t=r(a,l);window.location.href=t}),$(".colsfiltr").off("click",".Filtr_button"),$(".colsfiltr").on("click",".Filtr_button",function(a){var t=e(),i=r(t,l);window.location.href=i,a.preventDefault()})});